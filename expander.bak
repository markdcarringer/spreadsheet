#lang br/quicklang

(define-macro (spreadsheet-mb PARSE-TREE)
  #'(#%module-begin
     (void PARSE-TREE)))
(provide (rename-out [spreadsheet-mb #%module-begin]))

(define-macro (ss-program COMMAND-STRING ...)
  #'(string-append COMMAND-STRING ...))
(provide ss-program)

(define-macro (ss-set SET-STR)
  #'(set-func SET-STR))
(provide ss-set)

(define ht (make-hash))

(define (set-func input-str)
  (define args (string-split input-str))
  (define cell (first args))
  (define value (second args))
  (cond
    [(integer? value) (display (format "The value ~a is an integer. " value))]
    [(string? value) (display (format "The value ~a is a string. " value))])
;  (if (symbol? value)
;      (displayln (format "~a is a symbol." value))
;      (displayln (format "~a is not a symbol." value)))
  (hash-set! ht cell value)
  (displayln (format "The cell is ~a, the value is ~a." cell value))
  input-str)